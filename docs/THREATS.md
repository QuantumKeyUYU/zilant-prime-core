cat << 'EOF' > docs/THREATS.md
# Threat Model v0.1-core

## 1. STRIDE Analysis

| Категория          | Описание                                                                                             | Затронутые компоненты           |
|--------------------|------------------------------------------------------------------------------------------------------|---------------------------------|
| **S**poofing       | Подделка метаданных или заголовка контейнера — злоумышленник выдает себя за легитимный модуль.      | `container/pack.py`, `cli.py`   |
| **T**ampering      | Изменение содержимого или метаданных контейнера в хранилище или при передаче.                       | `container/unpack.py`           |
| **R**epudiation    | Отсутствие надёжных следов действий (логи можно подделать или стереть).                              | `utils/logging.py`              |
| **I**nformation Disclosure | Утечка ключей или внутренней информации через логи.                                           | `crypto/kdf.py`, `utils/logging.py` |
| **D**enial of Service | Перегрузка сервиса большими входными данными (VDF, fuzz).                                          | `vdf/vdf.py`, `cli.py`          |
| **E**levation of Privilege | Эксплуатация уязвимостей в C-коде или обход прав.                                           | `hdr/*.c`, `build/zil_c`        |

## 2. MITRE ATT&CK Mapping

| Technique ID | Название             | Описание                                          | Mitigation                  |
|--------------|----------------------|---------------------------------------------------|-----------------------------|
| T1078        | Valid Accounts       | Использование легитимных учётных записей          | MFA; мониторинг логинов     |
| T1496        | Resource Hijacking   | Захват ресурсов для своих процессов               | Rate limiting              |
| T1564        | Hide Artifacts       | Удаление или подмена логов                        | Write-once логи; Merkle     |
| T1021        | Remote Services      | Использование отладки (ptrace) или удалённых проксей | Отключить debug; seccomp  |
EOF
