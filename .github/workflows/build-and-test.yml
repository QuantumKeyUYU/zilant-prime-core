name: Build & Test

on:
  push:
    branches:
      - fix/ci-no-build-isolation
  pull_request:
    branches:
      - fix/ci-no-build-isolation

jobs:
  build-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Detect BOM/UTF-16 signatures
        run: |
          echo "â”Œâ”€â”€ ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¿ÐµÑ€Ð²Ñ‹Ðµ 3 Ð±Ð°Ð¹Ñ‚Ð° Ð²Ð¾ Ð²ÑÐµÑ… .py/.md/.toml"
          for f in $(find . -type f \( -name '*.py' -o -name '*.md' -o -name '*.toml' \)); do
            sig=$(head -c3 "$f" | xxd -p -u)
            case "$sig" in
              efbbbf* ) echo "ðŸ’¥ BOM UTF-8   -> $f" ;;
              fffe*   ) echo "ðŸ’¥ BOM UTF-16LE-> $f" ;;
              fffe*   ) echo "ðŸ’¥ BOM UTF-16BE-> $f" ;;
            esac
          done

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.11

      - name: Install dependencies
        run: pip install -e .[dev]
